{% extends 'base.html' %} {% block content %}

<div class="content-container" id="view-review-container">
    
<section id="book-info-section">
    
    <!-- Selected book title -->

    <h3>{{ review.title }}</h3>

    <!-- Selected book info container -->

    <div class="row">
        <div class="col s12">
            <p>By {{ review.author }}</p>
        </div>
    </div>

    <div class="row">

        <!-- Book cover image -->

        <div class="col l4 m4 s12"><img class="image-collection" src="{{ review.cover }}" alt="Picture of {{ review.title }}"></div>

        <!-- Book information -->

        <div class="col l8 m8 s12">
            <div class="row">
                <div class="col s12">
                    <p>Type: {{ review.type }}</p>
                </div>
            </div>
            <div class="row">
                <div class="col s12">
                    <p>Genre: {{ review.genre }}</p>
                </div>
            </div>
            <div class="row">
                <div class="col s12">
                    <p>Published: {{ review.publication_year }}</p>
                </div>
            </div>
            <div class="row">
                <div class="col s12">
                    <p>Review submitted by: {{ review.added_by }}</p>
                </div>
            </div>

            <!-- Like /dislike section -->

            <div class="row left">
                <div class="col s3"><i class="material-icons">thumb_up</i></div>
                <div class="col s2"><span>{{ review.upvote_total }}</span></div>
                <div class="col s3"><i class="material-icons">thumb_down</i></div>
                <div class="col s2"><span>{{ review.downvote_total }}</span></div>
            </div>

            <!-- Buy online button -->

            <div class="row">
                <div class="col s12 center-on-small-only"><button class="btn waves-effect waves-light"><a href="http://www.google.com/search?q={{ review.title }}" target="_new"></a>Buy online
                <i class="material-icons right">add_shopping_cart</i>
             </button></div>
            </div>

        </div>

    </div>

    <!-- Accordion element containing summery and review -->

    <div class="row">
        <div class="col s12">
            <ul class="collapsible" data-collapsible="accordion">
                <li>
                    <div class="collapsible-header">
                        <div class="accordion_header">
                            <i class="material-icons left">expand_more</i>Summary</div>
                    </div>
                    <div class="collapsible-body">
                        <span>
                    {{review.summary}} 
                </span>
                    </div>
                </li>
                <li>
                    <div class="collapsible-header">
                        <div class="accordion_header">
                            <i class="material-icons left">expand_more</i>Review</div>
                    </div>
                    <div class="collapsible-body">
                        <span>
                    {{review.review}} 
                </span>
                    </div>
                </li>
            </ul>
        </div>
    </div>

    <!-- Likes and like, Delete and Edit buttons -->

    <div class="row center">
        {% if current_user.username == review.added_by %}
        <div class="col s6"><a href="{{url_for('edit_review', review_id=review._id)}}" class="waves-effect waves-light btn btn_small">Edit<i class="material-icons right">edit</i></a></div>
        <div class="col s6"><a href="{{url_for('delete_review', review_id=review._id)}}" class="waves-effect waves-light btn btn_small">Delete<i class="material-icons right">delete</i></a></div>
        {% else %}
        <div class="col s6"><a href="{{ url_for('upvote', review_id=review._id ) }}" class="waves-effect waves-light btn btn_small">Like<i class="material-icons right">thumb_up</i></a></div>
        <div class="col s6"><a href="{{ url_for('downvote', review_id=review._id ) }}" class="waves-effect waves-light btn btn_small">Dislike<i class="material-icons right">thumb_down</i></a></div>
        {% endif %}
    </div>

    <hr>
    
</section>

    <!-- Comments heading -->
    <section id="comment-section">
        <div class="row">
            <h5><i class="small material-icons">forum</i>Comments</h5>
        </div>

        <!-- Insert comment -->

        <div class="row">
            <form action="{{ url_for('insert_comment', review_id=review._id ) }}" method="POST" class="col s12 comment-form">
                <div class="row">
                    <div class="input-field col m8 offset-m4 s12 center-on-small-only">
                        <textarea name="comment" id="textarea-comment" class="comments-textarea" placeholder="Please leave a comment..." data-length="10000" required></textarea>
                        <label for="textarea-comment">Leave a comment</label>
                    </div>
                </div>
                <div class="row">
                    <div class="col m8 offset-m4 right-align s12 center-on-small-only">
                        <button type="submit" name="action" class="btn waves-effect waves-light">Post
                <i class="material-icons right">comment</i>
             </button>
                    </div>
                </div>
            </form>
        </div>



        <!-- Latest comment -->

        {% for comment in comments %}

        <div class="row">
            <div class="col s12">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title">{{ comment.username }} says:</span>
                        <div id="card-container">{{ comment.comment }}</div>
                    </div>
                    
                    {% if current_user.username == comment.username %}
                    <div class="card-action">
                        <div class="row right-align">
                            <div class="col s3 offset-s6"><a href="" class="">Edit</a></div>
                            <div class="col s3"><a href="" class="">Delete</a></div>
                        </div>
                    </div>
                    {% endif %}
                    
                </div>
            </div>
        </div>
    
        {% endfor %}

    </section>
</div>
{% endblock %}
